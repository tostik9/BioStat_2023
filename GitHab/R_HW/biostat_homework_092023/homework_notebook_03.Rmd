---
title: "automatization_notebook_03"
output:
  html_document:
    df_print: paged
date: "`r Sys.Date()`"
outhor: Anatoliy Sozontov
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#install.packages("broom")

library(broom)

library(tidyverse)

```

# –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–í –≤–∞—à–µ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç framingham.

```{r}
data_raw <- read_csv("data/raw/framingham.csv")

```

# –í—ã–≤–µ–¥–∏—Ç–µ –æ–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```{r}

data_raw %>% summary()

```

# –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

1) –£–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –±–æ–ª—å—à–µ 20% –∏–ª–∏ —É–±–µ—Ä–∏—Ç–µ —Å—É–±—ä–µ–∫—Ç–æ–≤ —Å–æ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π. –ò–ª–∏ —Å–æ–≤–º–µ—Å—Ç–∏—Ç–µ –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞. –ù–∞–ø–∏—à–∏—Ç–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ, –ø–æ—á–µ–º—É –≤—ã –≤—ã–±—Ä–∞–ª–∏ —Ç–æ—Ç –∏–ª–∏ –∏–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç:

```{r}

# –ü–æ–¥—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
missing_percentage <- data_raw %>%
  summarise_all(~ sum(is.na(.)) / n()) %>%
  gather() %>%
  filter(value > 0.20)

if (nrow(missing_percentage) == 0) {
  cat("–ü–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π > 20% –Ω–µ—Ç.\n")
} else {
  cat("–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –±–æ–ª–µ–µ 20%:\n")
  cat(missing_percentage$key, sep = "\n")
}


# –ö–æ–¥ –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ –±—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ –ø–µ—Ä–º–µ–Ω–Ω—ã–µ(—Å—Ç–æ–ª–±—Ü—ã) –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ—Ü–µ–Ω—Ç 
# –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –±–æ–ª–µ–µ 20%
# 
# –Ø –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª —ç—Ç–æ—Ç –∫–æ–¥ —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ —Ç–∞–∫ –∫–∞–∫ –Ω–µ —Å—á–∏—Ç–∞—é —á—Ç–æ –º—ã –≤ –ø—Ä–∞–≤–µ 
# –æ—Ç–±—Ä–æ—Å–∏—Ç—å —Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –∑–Ω–∞—á–µ–Ω–∏—è—Ö –∫–æ—Ç–æ—Ä–æ–π —Ç–∞–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤

##################################################################
# data_raw_clean <- data_raw %>%
#   filter(rowSums(is.na(.)) / ncol(data_raw) <= 0.2)
##################################################################


# –£–∫–∞–∑–∞–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ –¥–ª—è –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
limit_per_NA_in_row <- 0.20

# –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ –±–æ–ª–µ–µ 20% –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–ø—É—â–µ–Ω—ã
filtered_data <- data_raw %>%
  mutate(percent_NA_row = rowSums(is.na(.)) / ncol(data_raw)) %>%
  filter(percent_NA_row > limit_per_NA_in_row)

# –í—ã–≤–æ–¥ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫
if (nrow(filtered_data) > 0) {
  cat("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ –∫–æ—Ä–æ—Ç—ã—Ö –ø—Ä–æ–ø—É—â–µ–Ω–æ –±–æ–ª–µ–µ 20% –∑–Ω–∞—á–µ–Ω–∏–π: ", nrow(filtered_data))
} else {
  cat("–í –¥–∞—Ç–∞—Å–µ—Ç–µ –Ω–µ—Ç —Å—Ç—Ä–æ–∫ –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ–ø—É—â–µ–Ω–æ –±–æ–ª–µ–µ —á–µ–º 20% –∑–∞–ø–∏—Å–µ–π.")

}

# –ú–ù–ï–ù–ò–ï:
# –í –æ–±—â–µ–º —Å–ª—É—á–∞–µ —è —Ç–∞–∫ –∂–µ –Ω–µ —Å—á–∏—Ç–∞—é –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –æ—Ç–±—Ä–∞—Å—ã–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ—Ç–æ—Ä—ã—Ö 
# –ø—Ä–æ–ø—É—â–µ–Ω—ã –∑–Ω–∞—á–µ–Ω–∏—è –±–æ–ª–µ–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –ù–ê –ú–û–ô –í–ó–ì–õ–Ø–î –±—É–¥–µ—Ç –∏–º–ø—É—Ç–∏—Ä–æ–≤–∞—Ç—å
# —Ç–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ.


# –°–æ–∑–¥–∞–¥–∏–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–∑–≤–∞–Ω–∏–π –∏ —Ç–∏–ø–æ–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å NA –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
# –§—É–Ω–∫—Ü–∏—è check_variables_with_na –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∞–≥—Ä—É–º–µ–Ω—Ç -- —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞

check_variables_with_na <- function(data) {
  variables_with_na <- sapply(data, function(x) any(is.na(x)))
  variable_names <- names(variables_with_na)
  variable_types <- sapply(data, class)
  
  has_na_values <- any(variables_with_na)

  if (has_na_values) {
    cat("–°–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–∏–ø–æ–≤ –≤ –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ NA –∑–Ω–∞—á–µ–Ω–∏–µ:\n")
    for (i in 1:length(variable_names)) {
      if (variables_with_na[i]) {
        cat("Variable:", variable_names[i], "Type:", variable_types[i], "\n")
      }
    }
  } else {
    cat("–ù–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å NA –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.\n")
  }
}

check_variables_with_na(data_raw)

```
**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**: 

–í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ - —ç—Ç–æ —á–∏—Å–ª–æ–≤—ã–µ –ø–µ—Ä–º–µ–Ω–Ω—ã–µ –∫—Ä–æ–º–µ education –∏ BPMeds.
–ö–∞–∫ –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è —ç—Ç–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–∞—è –ø—Ä–µ–º–µ–Ω–Ω–∞—è –≤ —á–∏—Å–ª–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–≤—è–∑–∞—Ç—å—Å—è —Å–æ —Å–ø–æ–Ω—Å–æ—Ä–æ–º –∏ –æ–±—Å—É–¥–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º 
–∏–º–ø—É—Ç–∞—Ü–∏–∏.

–ë—ã–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã —Å–ª–µ–¥—É—é—â–∏–µ –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏:

1. –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è education –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –Ω–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º 5, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç 
–¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ–¥–ª–∏—Å—Ç –ø–µ—Ä–º–µ–Ω–Ω–æ–π education –∫–∞–∫ "Not Available".

2. –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è BPMeds –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –Ω–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º 2, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç 
–¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ–¥–ª–∏—Å—Ç –ø–µ—Ä–º–µ–Ω–Ω–æ–π BPMeds –∫–∞–∫ "Not Available".

3. –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —á–∏—Å–ª–æ–≤—ã—Ö –ø–µ—Ä–µ–µ–Ω–Ω—ã—Ö cigsPerDay, 
totChol, BMI, heartRate, glucose –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –º–µ–¥–∏–∞–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–º–µ –æ–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–º
–¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ü–µ–ª–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤–≤–µ—Ä—Ö –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ ceiling(x).

```{r}
columns_to_replace_na <- c("cigsPerDay"
                          , "totChol"
                          , "BMI"
                          , "heartRate"
                          , "glucose")


data_with_imputation <- data_raw %>%
  mutate(
    across(all_of(columns_to_replace_na), ~ ceiling(median(., na.rm = TRUE))),
    education = ifelse(is.na(education), 5, education),
    BPMeds    = ifelse(is.na(BPMeds),    2, BPMeds)
    )

check_variables_with_na(data_with_imputation)

```

2) –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π –≤–∏–¥ (—á—Ç–æ –¥–µ–ª–∞—Ç—å —Å –ø—Ä–æ–±–µ–ª–∞–º–∏ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö?);

–Ø —Ä–µ—à–∏–ª –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è, 
–∞ —Ç–∞–∫ –∂–µ –∑–∞–º–µ–Ω–∏—Ç—å –ø—Ä–æ–±–µ–ª—ã –Ω–∏–∂–Ω–∏–º –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ–º
```{r}
# –°–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –ø–µ—Ä–µ–≤–æ–¥–æ–≤
translation_dict <- c(
  "–ü–æ–ª" = "male",
  "–í–æ–∑—Ä–∞—Å—Ç" = "age",
  "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ" = "education",
  "–¢–µ–∫—É—â–∏–π_–∫—É—Ä–∏–ª—å—â–∏–∫" = "currentSmoker",
  "–°–∏–≥–∞—Ä–µ—Ç_–≤_–¥–µ–Ω—å" = "cigsPerDay",
  "–ü—Ä–µ–ø–∞—Ä–∞—Ç—ã_–æ—Ç_–∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ_–¥–∞–≤–ª–µ–Ω–∏—è" = "BPMeds",
  "–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π_–∏–Ω—Å—É–ª—å—Ç" = "prevalentStroke",
  "–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–æ–µ_–≥–∏–ø–µ—Ä—Ç–æ–Ω–∏—è" = "prevalentHyp",
  "–°–∞—Ö–∞—Ä–Ω—ã–π_–¥–∏–∞–±–µ—Ç" = "diabetes",
  "–û–±—â–∏–π_—Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω" = "totChol",
  "–°–∏—Å—Ç–æ–ª–∏—á–µ—Å–∫–æ–µ_–¥–∞–≤–ª–µ–Ω–∏–µ" = "sysBP",
  "–î–∏–∞—Å—Ç–æ–ª–∏—á–µ—Å–∫–æ–µ_–¥–∞–≤–ª–µ–Ω–∏–µ" = "diaBP",
  "–ò–Ω–¥–µ–∫—Å_–º–∞—Å—Å—ã_—Ç–µ–ª–∞" = "BMI",
  "–ß–∞—Å—Ç–æ—Ç–∞_—Å–µ—Ä–¥–µ—á–Ω—ã—Ö_—Å–æ–∫—Ä–∞—â–µ–Ω–∏–π" = "heartRate",
  "–£—Ä–æ–≤–µ–Ω—å_–≥–ª—é–∫–æ–∑—ã" = "glucose",
  "–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç" = "TenYearCHD"
)


# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –∫–æ–ª–æ–Ω–∫–∏ –≤ data frame
data_with_imputation_1 <- rename(data_with_imputation, !!!translation_dict)
```

3) –í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫ –Ω—É–∂–Ω–æ–º—É —Ç–∏–ø—É (numeric –∏–ª–∏ factor);
```{r}
# –°–æ–∑–¥–∞–¥–∏–º —Å–ø–∏—Å–∫–∏ –¥–ª—è numeric –∏–ª–∏ factor –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
numeric_list <- c("–í–æ–∑—Ä–∞—Å—Ç"
                  , "–°–∏–≥–∞—Ä–µ—Ç_–≤_–¥–µ–Ω—å"
                  , "–û–±—â–∏–π_—Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω"
                  , "–°–∏—Å—Ç–æ–ª–∏—á–µ—Å–∫–æ–µ_–¥–∞–≤–ª–µ–Ω–∏–µ"
                  , "–î–∏–∞—Å—Ç–æ–ª–∏—á–µ—Å–∫–æ–µ_–¥–∞–≤–ª–µ–Ω–∏–µ"
                  , "–ò–Ω–¥–µ–∫—Å_–º–∞—Å—Å—ã_—Ç–µ–ª–∞"
                  , "–ß–∞—Å—Ç–æ—Ç–∞_—Å–µ—Ä–¥–µ—á–Ω—ã—Ö_—Å–æ–∫—Ä–∞—â–µ–Ω–∏–π"
                  , "–£—Ä–æ–≤–µ–Ω—å_–≥–ª—é–∫–æ–∑—ã")

factor_list  <- c( "–ü–æ–ª"
                  , "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"
                  , "–¢–µ–∫—É—â–∏–π_–∫—É—Ä–∏–ª—å—â–∏–∫"
                  , "–ü—Ä–µ–ø–∞—Ä–∞—Ç—ã_–æ—Ç_–∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ_–¥–∞–≤–ª–µ–Ω–∏—è"
                  , "–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π_–∏–Ω—Å—É–ª—å—Ç"
                  , "–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–æ–µ_–≥–∏–ø–µ—Ä—Ç–æ–Ω–∏—è"
                  , "–°–∞—Ö–∞—Ä–Ω—ã–π_–¥–∏–∞–±–µ—Ç"
                  , "–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç")

data_with_imputation_2 <- data_with_imputation_1 %>%
  mutate(
    # –ü—Ä–∏–≤–µ—Å—Ç–∏ —á–∏—Å–ª–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫ —Ç–∏–ø—É numeric
    across(all_of(numeric_list), ~ as.numeric(.)),
    
    # –ü—Ä–∏–≤–µ—Å—Ç–∏ —Ñ–∞–∫—Ç–æ—Ä–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫ —Ç–∏–ø—É factor
    across(all_of(factor_list), ~ as.factor(.))
        
  )
```

4) –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –ø–æ —É–±—ã–≤–∞–Ω–∏—é;

5) –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ —Ñ–∞–π–ª outliers.csv —Å—É–±—ä–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –≤—ã–±—Ä–æ—Å–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –ø—Ä–∞–≤–∏–ª—É —Ç—Ä—ë—Ö —Å–∏–≥–º) ‚Äî —ç—Ç–æ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ —Å–æ –∑–≤—ë–∑–¥–æ—á–∫–æ–π;

6) –ü—Ä–∏—Å–≤–æ–π—Ç–µ –ø–æ–ª—É—á–∏–≤—à–∏–π—Å—è –¥–∞—Ç–∞—Å–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π "cleaned_data".

```{r}

# –ø—Ä–æ–ø—É—Å—Ç–∏–ª –∑–∞–¥–∞–Ω–∏–µ 5, –ø–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –≤ –∫–∞–∫—É—é —Å—Ç–æ—Ä–æ–Ω—É –¥—É–º–∞—Ç—å? ü§î 

cleaned_data <- data_with_imputation_2 %>%
  arrange(desc(–í–æ–∑—Ä–∞—Å—Ç))

```

# –°–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–ª–æ—Å—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö?

```{r}

count_of_vars <- ncol(cleaned_data)
cat("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ:", count_of_vars)
```

# –°–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–ª–æ—Å—å —Å–ª—É—á–∞–µ–≤?

```{r}

count_of_rows <- nrow(cleaned_data)
cat("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ:", count_of_rows)

```

# –ï—Å—Ç—å –ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏?

```{r}


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
has_duplicates <- any(duplicated(cleaned_data))

if (has_duplicates) {
  cat("–î–∞—Ç–∞—Å–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã —Å—Ç—Ä–æ–∫.\n")
} else {
  cat("–î–∞—Ç–∞—Å–µ—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Å—Ç—Ä–æ–∫.\n")
}

# –£–¥–∞–ª–∏–º –ø–æ–ª–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã:

cleaned_data <- cleaned_data %>%
  distinct()

cat("–ü–æ–ª–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã —É–¥–∞–ª–µ–Ω—ã\n")

```

# –°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ –≤ –∫–∞–∂–¥–æ–π —Ç–∞–∫–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π?

```{r}

#–í—Å–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∑–∞–º–µ–Ω–µ–Ω—ã, —Å–º–æ—Ç—Ä–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –∑–∞–¥–∞–Ω–∏–µ 1

```

# –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

1) –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –¥–ª—è –≤—Å–µ—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã (TenYearCHD):

1.1) –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π;

1.2) –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π;

1.3) –°—Ä–µ–¥–Ω–µ–µ;

1.4) –ú–µ–¥–∏–∞–Ω—É;

1.5) –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ;

1.6) 25% –∫–≤–∞–Ω—Ç–∏–ª—å –∏ 75% –∫–≤–∞–Ω—Ç–∏–ª—å;

1.7) –ò–Ω—Ç–µ—Ä–∫–≤–∞—Ä—Ç–∏–ª—å–Ω—ã–π —Ä–∞–∑–º–∞—Ö;

1.8) –ú–∏–Ω–∏–º—É–º;

1.9) –ú–∞–∫—Å–∏–º—É–º;

1.10) 95% –î–ò –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ - –∑–∞–¥–∞–Ω–∏–µ —Å–æ –∑–≤—ë–∑–¥–æ—á–∫–æ–π.

```{r}

result <- data_with_imputation_2 %>%
  select(all_of(c(numeric_list, "–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç"))) %>%
  group_by(–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç) %>%
  summarise(across(where(is.numeric), list(
    n = ~n(),
    missing = ~sum(is.na(.)),
    mean = mean,
    mean_ci_lower = ~mean(.) - 1.96 * (sd(.) / sqrt(length(.))),  # 95% –Ω–∏–∂–Ω–∏–π –ø—Ä–µ–¥–µ–ª
    mean_ci_upper = ~mean(.) + 1.96 * (sd(.) / sqrt(length(.))),  # 95% –≤–µ—Ä—Ö–Ω–∏–π –ø—Ä–µ–¥–µ–ª
    median = median, 
    sd = sd, 
    quantile_25 = ~quantile(., 0.25),
    quantile_75 = ~quantile(., 0.75),
    iqr = ~quantile(., 0.75) - quantile(., 0.25),
    min = min, 
    max = max
  )))

result_table <- result %>%
  pivot_longer(cols = -–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç, names_to = "Statistic", values_to = "Value") %>%
  pivot_wider(names_from = –†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç, values_from = Value)

print(result_table)


```

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

1) –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã (TenYearCHD):

1.1) –ê–±—Å–æ–ª—é—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ;

1.2) –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã;

1.3) 95% –î–ò –¥–ª—è –¥–æ–ª–∏ –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã - –∑–∞–¥–∞–Ω–∏–µ —Å–æ –∑–≤—ë–∑–¥–æ—á–∫–æ–π.

```{r}

calculate_percentage <- function(data, group_var, factor_var) {
  result <- data %>%
    select({{ factor_var }}) %>%
    count(–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç, {{ group_var }}) %>%
    group_by(–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç) %>%
    mutate(`–ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ –≥—Ä—É–ø–ø–µ` = (n / sum(n)) * 100) %>%
    ungroup() %>%
    mutate(`–ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ –ø–æ–ø—É–ª—è—Ü–∏–∏` = (n / sum(n)) * 100)
  
  return(result)
}

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ —Å –∑–∞–º–µ–Ω–æ–π "–ü–æ–ª" 
result_factor_–ø–æ–ª <- calculate_percentage(data_with_imputation_2, –ü–æ–ª, factor_list)
result_factor_–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ <- calculate_percentage(data_with_imputation_2, –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, factor_list)
result_factor_–¢–µ–∫—É—â–∏–π_–∫—É—Ä–∏–ª—å—â–∏–∫ <- calculate_percentage(data_with_imputation_2, –¢–µ–∫—É—â–∏–π_–∫—É—Ä–∏–ª—å—â–∏–∫, factor_list)
result_factor_–ü—Ä–µ–ø–∞—Ä–∞—Ç—ã_–æ—Ç_–∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ_–¥–∞–≤–ª–µ–Ω–∏—è <- calculate_percentage(data_with_imputation_2, –ü—Ä–µ–ø–∞—Ä–∞—Ç—ã_–æ—Ç_–∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ_–¥–∞–≤–ª–µ–Ω–∏—è, factor_list)
result_factor_–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π_–∏–Ω—Å—É–ª—å—Ç <- calculate_percentage(data_with_imputation_2, –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π_–∏–Ω—Å—É–ª—å—Ç, factor_list)
result_factor_–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–æ–µ_–≥–∏–ø–µ—Ä—Ç–æ–Ω–∏—è <- calculate_percentage(data_with_imputation_2, –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–æ–µ_–≥–∏–ø–µ—Ä—Ç–æ–Ω–∏—è, factor_list)
result_factor_–°–∞—Ö–∞—Ä–Ω—ã–π_–¥–∏–∞–±–µ—Ç <- calculate_percentage(data_with_imputation_2, –°–∞—Ö–∞—Ä–Ω—ã–π_–¥–∏–∞–±–µ—Ç, factor_list)

```

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

## –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

1) –î–ª—è –∫–∞–∂–¥–æ–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å–¥–µ–ª–∞–π—Ç–µ –±–æ–∫—Å–ø–ª–æ—Ç—ã –ø–æ –≥—Ä—É–ø–ø–∞–º. –†–∞—Å–ø–æ–ª–æ–∂–∏—Ç–µ –∏—Ö –ª–∏–±–æ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ä–∏—Å—É–Ω–∫–∞—Ö, –ª–∏–±–æ –Ω–∞ –æ–¥–Ω–æ–º, –Ω–æ —á–∏—Ç–∞–µ–º–æ;

2) –ù–∞–ª–æ–∂–∏—Ç–µ –Ω–∞ –±–æ–∫—Å–ø–ª–æ—Ç—ã beeplots - –∑–∞–¥–∞–Ω–∏–µ —Å–æ –∑–≤—ë–∑–¥–æ—á–∫–æ–π.

3) –†–∞—Å–∫—Ä–∞—Å—å—Ç–µ –±–æ–∫—Å–ø–ª–æ—Ç—ã —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ RColorBrewer.

```{r}

library(ggplot2)
library(RColorBrewer)

# –í—ã–±–æ—Ä –ø–∞–ª–∏—Ç—Ä—ã —Ü–≤–µ—Ç–æ–≤
color_palette <- brewer.pal(8, "Set1")  # –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é –ø–∞–ª–∏—Ç—Ä—É —Ü–≤–µ—Ç–æ–≤

# –°–æ–∑–¥–∞–Ω–∏–µ –±–æ–∫—Å–ø–ª–æ—Ç–æ–≤ —Å —Ä–∞—Å–∫—Ä–∞—Å–∫–æ–π
for (variable in numeric_list) {
  # –°–æ–∑–¥–∞–π—Ç–µ –±–æ–∫—Å–ø–ª–æ—Ç —Å ggplot2
  plot_data <- data_with_imputation_2
  p <- ggplot(data = plot_data, aes(x = 1, y = .data[[variable]], fill = variable)) +
    geom_boxplot() +
    labs(title = variable) +
    theme_minimal() +
    theme(axis.title.x = element_blank(),
          axis.title.y = element_blank()) +
    scale_fill_manual(values = color_palette)  # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ü–≤–µ—Ç–∞ –∏–∑ –ø–∞–ª–∏—Ç—Ä—ã
  
  # –í—ã–≤–æ–¥ –±–æ–∫—Å–ø–ª–æ—Ç–∞
  print(p)
}

```

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

1) –°–¥–µ–ª–∞–π—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –û–±–æ—Å–Ω—É–π—Ç–µ, –ø–æ—á–µ–º—É –≤—ã–±—Ä–∞–ª–∏ –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç —Ç–∏–ø.

```{r}

# create dummy data
data <- data_with_imputation_2 %>% select(–ü–æ–ª)

# –¶–∏–∫–ª –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
for (variable in factor_list) {
  if (is.factor(data_with_imputation_2[[variable]])) {
    # –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —è–≤–ª—è–µ—Ç—Å—è —Ñ–∞–∫—Ç–æ—Ä–æ–º, —Å–æ–∑–¥–∞—Ç—å —Å—Ç–æ–ª–±—á–∞—Ç—É—é –¥–∏–∞–≥—Ä–∞–º–º—É
    plot <- ggplot(data_with_imputation_2, aes_string(x = variable)) +
      geom_bar(fill = "blue", color = "black") +
      labs(title = paste("–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞", variable), x = variable, y = "–ß–∞—Å—Ç–æ—Ç–∞")
  } else {
    # –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ñ–∞–∫—Ç–æ—Ä–æ–º, —Å–æ–∑–¥–∞—Ç—å –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É
    plot <- ggplot(data_with_imputation_2, aes_string(x = variable)) +
      geom_histogram(fill = "blue", color = "black") +
      labs(title = paste("–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞", variable), x = variable, y = "–ß–∞—Å—Ç–æ—Ç–∞")
  }
  
  print(plot)  # –í—ã–≤–æ–¥ –≥—Ä–∞—Ñ–∏–∫–∞
}


```

### –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

–Ø –≤—ã–±—Ä–∞–ª –≥–∏—Å—Ç–æ—Ä–∞–º–º—ã –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä—É–ø–ø –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–º–µ–Ω–Ω—ã—Ö

# –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ü–µ–Ω–∫–∏

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å

1) –û—Ü–µ–Ω–∏—Ç–µ –∫–∞–∂–¥—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é —Å –ø–æ–º–æ—â—å—é —Ç–µ—Å—Ç–∞ –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞. –ö–∞–∫–∏–µ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —è–≤–ª—è—é—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º–∏ –∏ –∫–∞–∫ –∫–∞–∫ –≤—ã —ç—Ç–æ –ø–æ–Ω—è–ª–∏?

```{r}

# –°–æ–∑–¥–∞–π—Ç–µ –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∞
results <- vector("list", length(numeric_list))
 cat("C–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é - —Ç–µ—Å—Ç –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞: \n")
# –ü—Ä–æ–π–¥–∏—Ç–µ –ø–æ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã
for (i in 1:length(numeric_list)) {
  var <- numeric_list[i]
  if (length(unique(data_with_imputation_2[[var]])) > 1) {
    result <- shapiro.test(data_with_imputation_2[[var]])
    results[[i]] <- result$p.value
  } else {
    cat(paste("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è ", var, "–∏–º–µ–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞\n"))
  }
}

# –í—ã–≤–µ–¥–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
for (i in 1:length(numeric_list)) {
  var <- numeric_list[i]
  if (!is.null(results[[i]])) {
    cat(paste("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è ", var, ": p-–∑–Ω–∞—á–µ–Ω–∏–µ =", results[[i]], "\n"))
  }
}

# –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ results –≤ –≤–µ–∫—Ç–æ—Ä
results <- unlist(results)

# –û—Ü–µ–Ω–∏—Ç–µ, –∫–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏
alpha <- 0.05
normal_variables <- numeric_list[results > alpha]

if (length(normal_variables) > 0) {
  cat("–ù–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:", normal_variables, "\n")
} else {
  cat("–ù–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏ —É—Ä–æ–≤–Ω–µ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ alpha =", alpha, "\n")
}


```

2) –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π QQ-–ø–ª–æ—Ç. –û—Ç–ª–∏—á–∞—é—Ç—Å—è –ª–∏ –≤—ã–≤–æ–¥—ã –æ—Ç —Ç–µ—Å—Ç–∞ –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞? –ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –≤—ã –±—ã –ø—Ä–µ–¥–ø–æ—á–ª–∏ –∏ –ø–æ—á–µ–º—É?

```{r}
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
# install.packages("ggplot2")
# install.packages("dplyr")
library(ggplot2)
library(dplyr)

# –í—ã–±–æ—Ä —Ç–æ–ª—å–∫–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ –≤–∞—à–µ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
numeric_vars <- data_with_imputation_2 %>% select_if(is.numeric)

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è QQ-–≥—Ä–∞—Ñ–∏–∫–∞
create_qq_plot <- function(data, var_name) {
  p <- ggplot(data, aes(sample = !!sym(var_name))) +
    geom_qq() +
    geom_qq_line() +
    labs(title = paste("QQ-–≥—Ä–∞—Ñ–∏–∫ –¥–ª—è", var_name)) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–∞–∑–≤–∞–Ω–∏—è
    theme(plot.title = element_text(hjust = 0.5)) +  # –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ —Ü–µ–Ω—Ç—Ä—É
    theme(plot.margin = margin(1, 1, 2, 1, "cm"))  # –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –≥—Ä–∞—Ñ–∏–∫–∞
  print(p)
}

# –°–æ–∑–¥–∞–π—Ç–µ –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç–µ QQ-–≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
for (var in colnames(numeric_vars)) {
  create_qq_plot(data_with_imputation_2, var)
}


```

–î–∞–Ω–Ω—ã–µ —Å–ª–µ–¥—É—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é: –ï—Å–ª–∏ —Ç–æ—á–∫–∏ –Ω–∞ QQ-–≥—Ä–∞—Ñ–∏–∫–µ —Å–ª–µ–¥—É—é—Ç –ø—Ä—è–º–æ–π –ª–∏–Ω–∏–∏ (–ª–∏–Ω–∏—è –¥–∏–∞–≥–æ–Ω–∞–ª–∏), —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ—á–µ–Ω—å –±–ª–∏–∑–∫–∏ –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é. –¢–∞–∫–∏–µ —Ç–æ—á–∫–∏ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è –≤–¥–æ–ª—å –¥–∏–∞–≥–æ–Ω–∞–ª–∏, –∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ç –¥–∏–∞–≥–æ–Ω–∞–ª–∏ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã.

–î–∏–æ—Å—Ç–∞–ª–∏—á–µ—Å–∫–æ–µ –∏ –°–∏—Å—Ç–æ–ª–∏—á–µ—Å–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ, –∞ —Ç–∞–∫ –∂–µ –≤–æ–∑—Ä–∞—Å—Ç –≤ —á–∞—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è "–ø–æ—Ö–æ–¥—è—Ç" –Ω–∞ "–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ", –æ–¥–Ω–∞–∫–æ –¥–∞–Ω–Ω—ã–µ —Å–º–µ—â–µ–Ω—ã –≤–ª–µ–≤–æ –∏–ª–∏ –≤–ø—Ä–∞–≤–æ, —ç—Ç–æ –º–æ–∂–µ—Ç —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ–≤–∞—Ç—å –æ –Ω–∞–ª–∏—á–∏–∏ –∞—Å–∏–º–º–µ—Ç—Ä–∏–∏ –≤ –¥–∞–Ω–Ω—ã—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ –Ω–∞–ª–∏—á–∏–∏ –¥–ª–∏–Ω–Ω–æ–≥–æ —Ö–≤–æ—Å—Ç–∞ –≤–ª–µ–≤–æ. –ï—Å–ª–∏ —Ç–æ—á–∫–∏ –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è –≤–ø—Ä–∞–≤–æ, —ç—Ç–æ –º–æ–∂–µ—Ç —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ–≤–∞—Ç—å –æ –Ω–∞–ª–∏—á–∏–∏ –∞—Å–∏–º–º–µ—Ç—Ä–∏–∏ —Å —Ö–≤–æ—Å—Ç–æ–º –≤–ø—Ä–∞–≤–æ.

–¢—è–∂–µ–ª—ã–µ —Ö–≤–æ—Å—Ç—ã (Fat Tails): –ï—Å–ª–∏ —Ç–æ—á–∫–∏ –Ω–∞ QQ-–≥—Ä–∞—Ñ–∏–∫–µ –≤—ã—Ö–æ–¥—è—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –¥–∏–∞–≥–æ–Ω–∞–ª–∏ –≤ –æ–±–ª–∞—Å—Ç—å —Ö–≤–æ—Å—Ç–æ–≤, —ç—Ç–æ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç—è–∂–µ–ª—ã—Ö —Ö–≤–æ—Å—Ç–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –≤—ã–±—Ä–æ—Å—ã –∏–ª–∏ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

–°-–æ–±—Ä–∞–∑–Ω–∞—è –∫—Ä–∏–≤–∞—è: –ï—Å–ª–∏ —Ç–æ—á–∫–∏ –Ω–∞ QQ-–≥—Ä–∞—Ñ–∏–∫–µ –æ–±—Ä–∞–∑—É—é—Ç S-–æ–±—Ä–∞–∑–Ω—É—é –∫—Ä–∏–≤—É—é, —ç—Ç–æ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –±–∏–º–æ–¥–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, —Ç–æ –µ—Å—Ç—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥–≤—É—Ö –ø–∏–∫–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö.

–ü—Ä—è–º–∞—è –ª–∏–Ω–∏—è —Å –∏–∑–≥–∏–±–∞–º–∏: –ï—Å–ª–∏ —Ç–æ—á–∫–∏ –Ω–∞ QQ-–≥—Ä–∞—Ñ–∏–∫–µ –æ–±—Ä–∞–∑—É—é—Ç –ø—Ä—è–º—É—é –ª–∏–Ω–∏—é —Å –∏–∑–≥–∏–±–∞–º–∏, —ç—Ç–æ –º–æ–∂–µ—Ç —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ–≤–∞—Ç—å –æ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö, –≥–¥–µ –Ω–µ–∫–æ—Ç–æ—Ä–∞—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –∏—Ö –±–ª–∏–∂–µ –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é.

–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è QQ-–≥—Ä–∞—Ñ–∏–∫–æ–≤ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ —Ü–µ–ª–µ–π –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–≥—É—Ç –ø–æ–º–æ—á—å –≤ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –∞—Å–∏–º–º–µ—Ç—Ä–∏–∏, –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö.







3) –ù–∏–∂–µ –Ω–∞–ø–∏—à–∏—Ç–µ, –∫–∞–∫–∏–µ –µ—â—ë –º–µ—Ç–æ–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å –≤—ã –∑–Ω–∞–µ—Ç–µ –∏ –∫–∞–∫–∏–µ —É –Ω–∏—Ö –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.

**–ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–¥–µ—Å—å**
–î–æ —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ —è –∑–Ω–∞–ª —Ç–æ–ª—å–∫–æ QQ —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞ "–Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å" –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–∏—à–ª–æ—Å—å –≥—É–≥–ª–∏—Ç—å :)

–¢–µ—Å—Ç –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞:
–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ: –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ –≤—ã–±–æ—Ä–∫–∞–º–∏ –∏ –∏–º–µ–µ—Ç –≤—ã—Å–æ–∫—É—é —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –¥–∞–∂–µ –Ω–µ–±–æ–ª—å—à–∏–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è–º –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏.
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –ú–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –º–µ–Ω–µ–µ –º–æ—â–Ω—ã–º –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö –≤—ã–±–æ—Ä–∫–∞—Ö. –û—Å–æ–±–µ–Ω–Ω–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –∞—Å–∏–º–º–µ—Ç—Ä–∏–∏ –¥–∞–Ω–Ω—ã—Ö.
–¢–µ—Å—Ç –î'–ê–≥–æ—Å—Ç–∏–Ω–æ-–ü–∏—Ä—Å–æ–Ω–∞:

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ: –ë–æ–ª–µ–µ –º–æ—â–µ–Ω –¥–ª—è –±–æ–ª—å—à–∏—Ö –≤—ã–±–æ—Ä–æ–∫, —á–µ–º —Ç–µ—Å—Ç –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞.
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –¢–∞–∫–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –∞—Å–∏–º–º–µ—Ç—Ä–∏–∏ –¥–∞–Ω–Ω—ã—Ö.
–¢–µ—Å—Ç –ê–Ω–¥–µ—Ä—Å–æ–Ω–∞-–î–∞—Ä–ª–∏–Ω–≥–∞:

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ: –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è–º –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ –≤ —Ö–≤–æ—Å—Ç–∞—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –û–≥—Ä–∞–Ω–∏—á–µ–Ω –≤ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –≤—ã–±–æ—Ä–æ–∫.
Q-Q –≥—Ä–∞—Ñ–∏–∫–∏:

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–≥—É—Ç –ø–æ–º–æ—á—å –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏.
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –¢—Ä–µ–±—É—é—Ç —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –º–µ–Ω–µ–µ —Ç–æ—á–Ω—ã–º–∏ –¥–ª—è –º–∞–ª—ã—Ö –≤—ã–±–æ—Ä–æ–∫.
–ì—Ä–∞—Ñ–∏–∫–∏ —è—â–∏–∫–∞ —Å —É—Å–∞–º–∏ (Boxplots):

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ: –ú–æ–≥—É—Ç –ø–æ–º–æ—á—å –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –≤—ã–±—Ä–æ—Å—ã –∏ –∞—Å–∏–º–º–µ—Ç—Ä–∏—é –≤ –¥–∞–Ω–Ω—ã—Ö.
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –ù–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏.
–ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ä—ã –∞—Å–∏–º–º–µ—Ç—Ä–∏–∏ –∏ —ç–∫—Å—Ü–µ—Å—Å–∞:

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ: –ú–æ–≥—É—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é –æ—Ü–µ–Ω–∫—É –∞—Å–∏–º–º–µ—Ç—Ä–∏–∏ –∏ –æ—Å—Ç—Ä–æ—Ç—ã –ø–∏–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –ù–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø—Ä—è–º—É—é –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –º–µ–Ω–µ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º–∏ –≤ —Å–ª—É—á–∞–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏.

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≥—Ä—É–ø–ø

1) –°—Ä–∞–≤–Ω–∏—Ç–µ –≥—Ä—É–ø–ø—ã (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è **TenYearCHD**) –ø–æ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (–∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π, —Ç–∞–∫ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ–π). –î–ª—è –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π –∏ –∫—Ä–∞—Ç–∫–æ –æ–±–æ—Å–Ω—É–π—Ç–µ –µ–≥–æ –≤—ã–±–æ—Ä –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö.

–Ø –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é —á—Ç–æ –≤ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –≤—Å–µ–≥–æ —Ç—Ä–∏ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö:

1. –î–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —è –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏ —Ç–µ—Å—Ç –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏ —Ç–∞–∫ –∫–∞–∫ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —à–∞–≥–∞—Ö –º—ã –≤—ã—è—Å–Ω–∏–ª–∏ —á—Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è –Ω—É–º–µ—Ä–∏–∫ –ø–µ—Ä–º–µ–Ω–Ω—ã—Ö –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é

2. –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—á–Ω—ã–π —Ç–µ—Å—Ç –§–∏—à–µ—Ä–∞

3. –î–ª—è –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ö–∏ –∫–≤–∞–¥—Ä–∞—Ç
```{r}
compare_data_0 <- data_with_imputation_2
compare_data_0 %>% summary()
# compare_data_0 %>% filter(–°–∏–≥–∞—Ä–µ—Ç_–≤_–¥–µ–Ω—å != 0)
```



```{r}
# –°–æ–∑–¥–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
continuous_variables <- c("–í–æ–∑—Ä–∞—Å—Ç"
                          , "–°–∏–≥–∞—Ä–µ—Ç_–≤_–¥–µ–Ω—å"
                          , "–û–±—â–∏–π_—Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω"
                          , "–°–∏—Å—Ç–æ–ª–∏—á–µ—Å–∫–æ–µ_–¥–∞–≤–ª–µ–Ω–∏–µ"
                          , "–î–∏–∞—Å—Ç–æ–ª–∏—á–µ—Å–∫–æ–µ_–¥–∞–≤–ª–µ–Ω–∏–µ"
                          , "–ò–Ω–¥–µ–∫—Å_–º–∞—Å—Å—ã_—Ç–µ–ª–∞"
                          , "–ß–∞—Å—Ç–æ—Ç–∞_—Å–µ—Ä–¥–µ—á–Ω—ã—Ö_—Å–æ–∫—Ä–∞—â–µ–Ω–∏–π"
                          , "–£—Ä–æ–≤–µ–Ω—å_–≥–ª—é–∫–æ–∑—ã"
                          )





```

### –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ –ø–µ—Ä–º–µ–Ω–Ω—ã–µ
```{r}
# –°–æ–∑–¥–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
interpretation <- list()

# –í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –¥–∞–Ω–Ω—ã–µ
data_to_compare <- compare_data_0[, c("–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç", continuous_variables)]

# –†–∞–∑–±–µ–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ "–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç"
group_0 <- data_to_compare[data_to_compare$–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç == "0", ]
group_1 <- data_to_compare[data_to_compare$–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç == "1", ]

# –°–æ–∑–¥–∞–π—Ç–µ –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
results_and_interpretation <- list()

# –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
for (variable in continuous_variables) {
  if (length(unique(group_0[[variable]])) == 1 && length(unique(group_1[[variable]])) == 1) {
    interpretation_text <- "–í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã –∏ –Ω–µ—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏ –≤ –¥–∞–Ω–Ω—ã—Ö."
  } else {
    result <- wilcox.test(group_0[[variable]], group_1[[variable]], na.action = na.omit)
    p_value <- result$p.value
    if (!is.na(p_value)) {
      interpretation_text <- if (p_value < 0.05) {
        "–°—É—â–µ—Å—Ç–≤—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏."
      } else {
        "–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ."
      }
    } else {
      interpretation_text <- "–î–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è."
    }
  }
  
  result_and_interpretation <- paste(
    "–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è:", variable,
    "p-–∑–Ω–∞—á–µ–Ω–∏–µ:", ifelse(is.na(p_value), "NaN", p_value),
    "–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:", interpretation_text
  )
  
  results_and_interpretation[[variable]] <- result_and_interpretation
}

# –í—ã–≤–µ–¥–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é
results_and_interpretation


```


### –û—à–∏–±–∫–∞: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–º–µ–Ω–Ω—ã—Ö —É –º–µ–Ω—è –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –Ω–µ –º–æ–≥–ª–∏ –±—ã –≤—ã, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥—Å–∫–∞–∑–∞—Ç—å –≤ —á–µ–º —è –æ—à–∏–±–∞—é—Å—å?
```{r}
# # –°–æ–∑–¥–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
# interpretation <- list()
# 
# # –í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –¥–∞–Ω–Ω—ã–µ
# data_to_compare <- compare_data_0[, c("–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç", "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ", "–ü—Ä–µ–ø–∞—Ä–∞—Ç—ã_–æ—Ç_–∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ_–¥–∞–≤–ª–µ–Ω–∏—è")]
# 
# # –†–∞–∑–±–µ–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ "–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç"
# group_0 <- data_to_compare[data_to_compare$–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç == 0, ]
# group_1 <- data_to_compare[data_to_compare$–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç == 1, ]
# 
# # –°–æ–∑–¥–∞–π—Ç–µ –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
# results_and_interpretation <- list()
# 
# # –û–±—ä–µ–¥–∏–Ω–∏—Ç–µ —É—Ä–æ–≤–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –æ–±–µ–∏—Ö –≥—Ä—É–ø–ø–∞—Ö
# unique_levels <- unique(c(group_0$–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, group_1$–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, group_0$–ü—Ä–µ–ø–∞—Ä–∞—Ç—ã_–æ—Ç_–∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ_–¥–∞–≤–ª–µ–Ω–∏—è, group_1$–ü—Ä–µ–ø–∞—Ä–∞—Ç—ã_–æ—Ç_–∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ_–¥–∞–≤–ª–µ–Ω–∏—è))
# 
# # –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
# for (variable in c("–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ", "–ü—Ä–µ–ø–∞—Ä–∞—Ç—ã_–æ—Ç_–∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ_–¥–∞–≤–ª–µ–Ω–∏—è")) {
#   # –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏ —Å —É—á–µ—Ç–æ–º —É—Ä–æ–≤–Ω–µ–π –≤ –æ–±–µ–∏—Ö –≥—Ä—É–ø–ø–∞—Ö
#   contingency_table <- table(factor(group_0[[variable]], levels = unique_levels), factor(group_1[[variable]], levels = unique_levels))
#   
#   result <- chisq.test(contingency_table)
#   p_value <- result$p.value
#   interpretation_text <- if (p_value < 0.05) {
#     "–°—É—â–µ—Å—Ç–≤—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏."
#   } else {
#     "–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ."
#   }
# 
#   result_and_interpretation <- paste(
#     "–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è:", variable,
#     "p-–∑–Ω–∞—á–µ–Ω–∏–µ:", ifelse(is.na(p_value), "NaN", p_value),
#     "–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:", interpretation_text
#   )
# 
#   results_and_interpretation[[variable]] <- result_and_interpretation
# }
# 
# # –í—ã–≤–µ–¥–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é
# results_and_interpretation

```

```{r}
# –°–æ–∑–¥–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ –¥–ª—è –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
binary_variables <- c("–ü–æ–ª"
                      , "–¢–µ–∫—É—â–∏–π_–∫—É—Ä–∏–ª—å—â–∏–∫"
                      , "–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π_–∏–Ω—Å—É–ª—å—Ç"
                      , "–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–æ–µ_–≥–∏–ø–µ—Ä—Ç–æ–Ω–∏—è"
                      , "–°–∞—Ö–∞—Ä–Ω—ã–π_–¥–∏–∞–±–µ—Ç"
                      )

# –í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –¥–∞–Ω–Ω—ã–µ
data_to_compare <- compare_data_0[, c("–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç", binary_variables)]

# –†–∞–∑–±–µ–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ "–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç"
group_0 <- data_to_compare[data_to_compare$–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç == "0", ]
group_1 <- data_to_compare[data_to_compare$–†–∏—Å–∫_CHD_–Ω–∞_10_–ª–µ—Ç == "1", ]

# –°–æ–∑–¥–∞–¥–∏–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏
create_contingency_table <- function(group_0, group_1) {
  unique_values <- unique(c(group_0, group_1))
  n_values <- length(unique_values)
  contingency_table <- matrix(0, nrow = n_values, ncol = 2)

  for (i in 1:n_values) {
    value <- unique_values[i]
    if (!is.na(value) && length(group_0) > 0 && length(group_1) > 0) {
      contingency_table[i, 1] <- sum(group_0 == value)
      contingency_table[i, 2] <- sum(group_1 == value)
    }
  }

  # –£–¥–∞–ª–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ –æ–±–∞ —Å—Ç–æ–ª–±—Ü–∞ —Ä–∞–≤–Ω—ã –Ω—É–ª—é
  contingency_table <- contingency_table[!(contingency_table[, 1] == 0 & contingency_table[, 2] == 0), ]

  rownames(contingency_table) <- unique_values[!is.na(unique_values)]
  colnames(contingency_table) <- c("Group_0", "Group_1")

  return(contingency_table)
}

# —Ç–µ—Å—Ç chi-squared —Ç–æ–ª—å–∫–æ –¥–ª—è –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
results_and_interpretation <- list()

for (variable in binary_variables) {
  group_0_data <- group_0[[variable]]
  group_1_data <- group_1[[variable]]
  
  if (!is.null(group_0_data) && !is.null(group_1_data)) {
    contingency_table <- create_contingency_table(group_0_data, group_1_data)
    
    if (nrow(contingency_table) > 0) {  # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
      result <- chisq.test(contingency_table)
      p_value <- result$p.value
      df <- result$parameter
      interpretation_text <- if (p_value < 0.05) {
        "–°—É—â–µ—Å—Ç–≤—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏."
      } else {
        "–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ."
      }
  
      result_and_interpretation <- paste(
        "–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è:", variable,
        "p-–∑–Ω–∞—á–µ–Ω–∏–µ:", p_value,
        "–°—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã:", df,
        "–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:", interpretation_text
      )
  
      results_and_interpretation[[variable]] <- result_and_interpretation
    }
  }
}

# —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é
results_and_interpretation

```

# –î–∞–ª–µ–µ –∏–¥—É—Ç **–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ** –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏–Ω–µ—Å—Ç–∏ –≤–∞–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –±–∞–ª–ª—ã –≤ —Ç–æ–º —á–∏—Å–ª–µ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö

## –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑

1) –°–æ–∑–¥–∞–π—Ç–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏ –ø–æ–ø—Ä–∞–≤–∫–æ–π –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è. –û–±—ä—è—Å–Ω–∏—Ç–µ, –∫–æ–≥–¥–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –∏ –≤ —á—ë–º –º–∏–Ω—É—Å—ã –∏ –ø–ª—é—Å—ã –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π.

## –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

1) –ü–æ—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π **TenYearCHD**. –û–ø–∏—à–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è

```{r}



```




